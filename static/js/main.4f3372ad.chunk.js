(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{148:function(e,t,n){e.exports=n(352)},351:function(e,t,n){},352:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(56),c=n.n(o),l=n(34),i=n.n(l),s=n(145),u=n(82),m=n(139),p=n(140),d=n(146),h=n(141),g=n(147),f=n(35),v=n(10),E=n(144),y=n.n(E),w=new v.Color("skyblue"),b=function(e){for(var t=new Float32Array(e),n=[],a=0;a<t.length-1;a+=4){var r=t[a],o={x:t[a+1],y:t[a+2],z:r};n.push(o)}return n},x=function(){return new v.Geometry},L=function(e,t){var n=t.map(function(e){return new v.Vector3(e.x,e.y,e.z)}),a=Array(t.length).fill(w);e.vertices=e.vertices.concat(n),e.colors=e.colors.concat(a)},k=function(e){var t=new v.PointsMaterial({size:2,sizeAttenuation:!1,vertexColors:v.VertexColors});return new v.Points(e,t)},P=function(){var e=document.getElementById("lidar"),t=new v.Scene,n=e.clientWidth,a=e.clientHeight,r=n/a,o=new v.PerspectiveCamera(45,r,1,1e4);o.position.set(0,100,0),o.lookAt(new v.Vector3(0,0,0)),t.add(o);var c=new v.AxesHelper(50);t.add(c);var l=new v.WebGLRenderer;l.setSize(n,a);var i={scene:t,camera:o,renderer:l,orbitControls:new y.a(o,l.domElement)};return window.THREE=v,window.q=i,i},C=(n(351),Object(f.withScriptjs)(Object(f.withGoogleMap)(function(e){return r.a.createElement(f.GoogleMap,{defaultZoom:20,center:e.currentLatLng},r.a.createElement(f.Polyline,{path:e.polylinePath}))}))),j=function(e){return new Promise(function(t){setTimeout(t,e)})},O=["image_00","image_01","image_02","image_03"],S=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={polylinePath:[],currentLatLng:{lat:49.011212804408,lng:8.4228850417969},count:0,imageFolder:O[0]},n.componentDidMount=function(){n.map=P(),n.container.current.appendChild(n.map.renderer.domElement);!function e(){requestAnimationFrame(e),n.map.renderer.render(n.map.scene,n.map.camera)}(),n.start()},n.fetchData=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=("0000000000"+n.state.count).slice(-10),e.next=3,fetch("/ottometric-app"+"/drive_data/velodyne_points/data/".concat(t,".bin")).then(function(e){return e.arrayBuffer()}).then(function(e){var t=b(e);L(n.geometry,t),n.lastPointCloud&&n.map.scene.remove(n.lastPointCloud),n.lastPointCloud=k(n.geometry),n.geometry.dispose(),n.geometry=x(),n.map.scene.add(n.lastPointCloud)});case 3:return e.next=5,fetch("/ottometric-app"+"/drive_data/oxts/data/".concat(t,".txt")).then(function(e){return e.text()}).then(function(e){return e.split(" ",2)}).then(function(e){var t={lat:Number(e[0]),lng:Number(e[1])},a=[].concat(Object(s.a)(n.state.polylinePath),[t]);n.setState({currentLatLng:t,polylinePath:a})});case 5:console.log(t),n.setState({count:n.state.count+1});case 7:case"end":return e.stop()}},e)})),n.start=Object(u.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.play){e.next=2;break}return e.abrupt("return");case 2:n.setState({play:!0}),e.prev=3;case 4:return e.next=6,n.fetchData();case 6:return e.next=8,j(50);case 8:if(!1!==n.state.play){e.next=10;break}return e.abrupt("break",12);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:return e.prev=17,n.setState({play:!1}),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[3,14,17,20]])})),n.stop=function(){n.setState({play:!1})},n.reset=function(){n.setState({polylinePath:[],currentLatLng:{lat:49.011212804408,lng:8.4228850417969},count:0})},n.changeImageFolder=function(e){n.setState({imageFolder:e.target.value})},n.container=r.a.createRef(),n.geometry=x(),n.play=!1,n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=("0000000000"+(this.state.count>0?this.state.count-1:this.state.count)).slice(-10);return r.a.createElement("div",{className:"app"},r.a.createElement("header",null,r.a.createElement("div",null,"OTTOMETRIC"),r.a.createElement("select",{onChange:this.changeImageFolder},O.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("main",null,r.a.createElement("div",{className:"googlemap"},r.a.createElement(C,{googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=drawing&key=AIzaSyD6qTu55F0bSv_Bj05mxZ8ffvxyP2rzxO0",loadingElement:r.a.createElement("div",null),containerElement:r.a.createElement("div",{style:{width:"100%",height:"100%"}}),mapElement:r.a.createElement("div",{style:{width:"100%",height:"100%"}}),currentLatLng:this.state.currentLatLng,polylinePath:this.state.polylinePath})),r.a.createElement("section",null,r.a.createElement("div",{id:"lidar",ref:this.container}),r.a.createElement("aside",null,r.a.createElement("div",{className:"camera"},r.a.createElement("img",{src:"/ottometric-app"+"/drive_data/".concat(this.state.imageFolder,"/data/").concat(e,".png"),alt:""})),r.a.createElement("div",{className:"information"},r.a.createElement("div",null,r.a.createElement("b",null,"Photo:"),r.a.createElement("br",null),"".concat(e,".png")),r.a.createElement("div",null,r.a.createElement("b",null,"Latitude:"),r.a.createElement("br",null)," ",this.state.currentLatLng.lat),r.a.createElement("div",null,r.a.createElement("b",null,"Longitude:"),r.a.createElement("br",null)," ",this.state.currentLatLng.lng))))),r.a.createElement("footer",null,!this.state.play&&r.a.createElement("button",{onClick:this.start},"start"),this.state.play&&r.a.createElement("button",{onClick:this.stop},"stop"),r.a.createElement("button",{onClick:this.reset},"reset")))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[148,1,2]]]);
//# sourceMappingURL=main.4f3372ad.chunk.js.map